
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2017-10-31
 Rendered using Msb3 Maven Skin 0.1.1 (http://tunguski.github.io/msb3-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Revapi Java Extension - Annotated Element Filter</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://bootswatch.com/cosmo/bootstrap.min.css" rel="stylesheet" />
		<link href="../css/bootswatch.css" rel="stylesheet" />
		<link href="../css/msb3-skin.css" rel="stylesheet" />

		<link href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/default.min.css" rel="stylesheet" />

		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>(adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3133590320590126",
          enable_page_level_ads: true
        });</script>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-57095904-1', 'auto');
        ga('send', 'pageview');</script>
<link rel="alternate" href="https://revapi.org/news.atom" type="application/rss+xml" title="Revapi News"/>
	</head>

	<body class="page-extensions-annotated-elem-filter project-revapi-java" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<header class="navbar navbar-default navbar-fixed-top">
			<div class="container">
				<div class="navbar-header">
					<a class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="navbar-brand" href="../../..">Revapi</a>
				</div>
					<div class="collapse navbar-collapse" id="top-nav-collapse">
						<ul class="nav navbar-nav navbar-right">
							<li ><a href="https://diff.revapi.org" title="Online Check" class="externalLink">Online Check</a></li>
							<li ><a href="../../../news.html" title="News">News</a></li>
							<li ><a href="../../../getting-started.html" title="Getting Started">Getting Started</a></li>
							<li ><a href="../../../downloads.html" title="Downloads">Downloads</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Basic Info <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../../../architecture.html" title="Architecture">Architecture</a></li>
									<li ><a href="../../../building.html" title="Building">Building</a></li>
									<li ><a href="../../../extensions.html" title="Extensions">Extensions</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Sub Projects <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../../revapi/index.html" title="Revapi API">Revapi API</a></li>
									<li ><a href="../../revapi-ant-task/index.html" title="Ant Task">Ant Task</a></li>
									<li ><a href="../../revapi-basic-features/index.html" title="Basic Features">Basic Features</a></li>
									<li ><a href="../index.html" title="Java Extension">Java Extension</a></li>
									<li ><a href="../../revapi-java-spi/index.html" title="Java Extension SPI">Java Extension SPI</a></li>
									<li ><a href="../../revapi-java-test-support/index.html" title="Java Test Support">Java Test Support</a></li>
									<li ><a href="../../revapi-reporter-text/index.html" title="Text Report Extension">Text Report Extension</a></li>
									<li ><a href="../../revapi-maven-plugin/index.html" title="Maven Plugin">Maven Plugin</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Details <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../differences.html" title="Detected API differences">Detected API differences</a></li>
									<li ><a href="../enhance-java-checks.html" title="Extending Java API Checks">Extending Java API Checks</a></li>
									<li ><a href="java.html" title="Java Extension Configuration">Java Extension Configuration</a></li>
									<li class="active"><a href="" title="Annotated Element Filter Extension Configuration">Annotated Element Filter Extension Configuration</a></li>
									<li ><a href="class-filter.html" title="Class Filter Extension">Class Filter Extension</a></li>
									<li ><a href="package-filter.html" title="Package Filter Extension">Package Filter Extension</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
			</div>
		</header>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron">
		<div class="row">
			<div class="col-md-12">
				<div class="pull-left">
					<a href="https://revapi.org/modules/revapi-java" id="bannerLeft"><h1>Revapi Java Extension</h1></a>
					<p class="lead">Revapi extension to check API of java classes in jar archives.</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="col-md-8">
			<div class="body-content">
<div class="sect1"> 
 <div class="page-header">
  <h2 id="a_annotated_element_filter">Annotated Element Filter</h2>
 </div> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p><strong>Extension</strong>: <code>revapi.java.filter.annotated</code></p> 
  </div> 
  <div class="paragraph"> 
   <p>The annotated element filter is able to include or exclude java elements based on the presence of certain annotation on them. This also works for annotations with certain attributes having certain values, because the match is done on the "standard" annotation textual notation.</p> 
  </div> 
  <div class="paragraph"> 
   <p>If no <code>include</code> filter is specified, all elements are included, otherwise only the elements annotated with one of the <code>included</code> annotations are API checked.</p> 
  </div> 
  <div class="paragraph"> 
   <p>The <code>exclude</code> filter narrows down the included elements - i.e. if an element is to be included according to the include filter (or lack thereof), the exclude filter is consulted whether that really should be the case.</p> 
  </div> 
  <div class="paragraph"> 
   <p>If an element is included, all its child elements are included, too. I.e. if a class is included, all its methods, fields and inner classes are included in the analysis, too (if you need to exclude some child element that would be included by default, you can either annotate it with some annotation and configure this filter to exclude such elements, or you can use some other Revapi filter, like <a href="../../revapi-basic-features/extensions/filter.html">configurable element filter</a>).</p> 
  </div> 
  <div class="admonitionblock note"> 
   <table> 
    <tbody> 
     <tr> 
      <td class="icon"> 
       <div class="title">
         Note 
       </div> </td> 
      <td class="content"> Currently, this filter does NOT take into account annotations placed on the packages. </td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div class="sect2"> 
   <h3 id="a_sample_configuration">Sample Configuration</h3> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-javascript" data-lang="javascript">[
  {
    "extension": "revapi.java.filter.annotated",
    "configuration": {
      "regex": true,
      "include": ["@my\\.annotations\\.Public.*"],
      "exclude": ["@my\\.annotations\\.Beta"]
    }
  }
]</code></pre> 
    </div> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-xml" data-lang="xml">&lt;analysisConfiguration&gt;
  &lt;revapi.java.filter.annotated&gt;
    &lt;regex&gt;true&lt;/regex&gt;
    &lt;include&gt;
      &lt;item&gt;@my\.annotations\.Public.*&lt;/item&gt;
    &lt;/include&gt;
    &lt;exclude&gt;
      &lt;item&gt;@my\.annotations\.Beta&lt;/item&gt;
    &lt;/exclude&gt;
  &lt;/revapi.java.filter.annotated&gt;
&lt;/analysisConfiguration&gt;</code></pre> 
    </div> 
   </div> 
  </div> 
  <div class="sect2"> 
   <h3 id="a_properties">Properties</h3> 
   <div class="dlist"> 
    <dl> 
     <dt class="hdlist1"> 
      <code>regex</code> 
     </dt> 
     <dd> 
      <p>Specifies whether to consider the strings in <code>exclude</code> and <code>include</code> lists as regular expressions or not. The default value is <code>false</code>, meaning the strings are not considered as regular expressions.</p> 
     </dd> 
     <dt class="hdlist1"> 
      <code>exclude</code> 
     </dt> 
     <dd> 
      <p>Elements annotated with annotation that matches at least one from this list will be excluded from the API check.</p> 
     </dd> 
     <dt class="hdlist1"> 
      <code>include</code> 
     </dt> 
     <dd> 
      <p>Elements annotated with annotation that matches at least one from this list will be included from the API check.</p> 
     </dd> 
    </dl> 
   </div> 
  </div> 
  <div class="sect2"> 
   <h3 id="a_notation">Notation</h3> 
   <div class="paragraph"> 
    <p>The string formatting of the annotations with values follows that of Java8. Notably:</p> 
   </div> 
   <div class="ulist"> 
    <ul> 
     <li> <p>The full canonical class names are used for every type.</p> </li> 
     <li> <p>If the annotation specifies only the value of the <code>value</code> attribute, the name, <code>value</code>, must not be included in the notation. I.e. <code>@java.lang.annotation.Retention(java.lang.annotation.RetentionPolicy.RUNTIME)</code>, not <code>@java.lang.annotation.Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)</code>.</p> </li> 
     <li> <p>Array attributes are always enclosed in curly braces even if only a single element is present, i.e. <code>@java.lang .annotation.Target({java.lang.annotation.ElementType.METHOD})</code>, not <code>@java.lang.annotation.Target(java.lang.annotation.ElementType.METHOD)</code>.</p> </li> 
     <li> <p>Equals sign is always surrounded by a single space from each side.</p> </li> 
    </ul> 
   </div> 
  </div> 
  <div class="sect2"> 
   <h3 id="a_examples">Examples</h3> 
   <div class="paragraph"> 
    <p>Let’s consider the following classes in our API, that we want to filter:</p> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-java" data-lang="java">@Public
public class MyAPI {

   public static final int CONSTANT = 42;

   public void method() {
   }

   public static class InnerAPI {
   }

   @Private
   public static class InnerImplementation {
   }
}

@Private
public class Implementation {

    public static final int DETAIL = 43;

    @Public
    public void method() {
    }
}


public class JustAClass {

    public void method() {
    }

    @Private
    public void implMethod() {
    }

    @Public
    public void definitelyAPIMethod() {
    }
}</code></pre> 
    </div> 
   </div> 
   <div class="paragraph"> 
    <p>Given the classes above, the following example configurations will show different ways of setting up the filtering to achieve anticipated results.</p> 
   </div> 
   <div class="admonitionblock note"> 
    <table> 
     <tbody> 
      <tr> 
       <td class="icon"> 
        <div class="title">
          Note 
        </div> </td> 
       <td class="content"> The <code>@Public</code> and <code>@Private</code> annotations are not defined by Revapi. They just represent any annotation you may choose to be used in their place for the same purpose. </td> 
      </tr> 
     </tbody> 
    </table> 
   </div> 
   <div class="sect3"> 
    <h4 id="a_leave_out_only_code_private_code_elements">Leave out only <code>@Private</code> Elements</h4> 
    <div class="paragraph"> 
     <p>This one of the simple approaches. You don’t want to sprinkle your code with annotations everywhere - most of your classes are to be considered public but you want to make sure that certain classes are not meant for public consumption. You neither use Java 9, nor you mandate execution in some of the modular classloading frameworks like OSGi or JBoss Modules, so your options are limited in terms of visibility and you might not have other choice but to make even these classes public.</p> 
    </div> 
    <div class="paragraph"> 
     <p>If you configure Revapi like this:</p> 
    </div> 
    <div class="listingblock"> 
     <div class="content"> 
      <pre class="highlight"><code class="language-javascript" data-lang="javascript">[
  {
    "extension": "revapi.java.filter.annotated",
    "configuration": {
      "exclude": ["@my.annotations.Private"]
    }
  }
]</code></pre> 
     </div> 
    </div> 
    <div class="paragraph"> 
     <p>The API analysis will not consider these elements:</p> 
    </div> 
    <div class="ulist"> 
     <ul> 
      <li> <p><code>MyAPI.InnerImplementation</code> class</p> </li> 
      <li> <p><code>Implementation</code> class and any of its members</p> </li> 
      <li> <p><code>JustAClass.implMethod()</code> method</p> </li> 
     </ul> 
    </div> 
    <div class="paragraph"> 
     <p>All other elements will be included in the analysis.</p> 
    </div> 
   </div> 
   <div class="sect3"> 
    <h4 id="a_only_consider_code_public_code_elements">Only Consider <code>@Public</code> Elements</h4> 
    <div class="paragraph"> 
     <p>This is an approach where you want to have strict control over what is considered public API and what is not. You do this by annotating the elements to be considered part of the public API using the <code>@Public</code> annotation (of your own making).</p> 
    </div> 
    <div class="paragraph"> 
     <p>The Revapi configuration for this might include this snippet:</p> 
    </div> 
    <div class="listingblock"> 
     <div class="content"> 
      <pre class="highlight"><code class="language-javascript" data-lang="javascript">[
  {
    "extension": "revapi.java.filter.annotated",
    "configuration": {
      "include": ["@my.annotations.Public"]
    }
  }
]</code></pre> 
     </div> 
    </div> 
    <div class="paragraph"> 
     <p>The API analysis will not consider these elements:</p> 
    </div> 
    <div class="ulist"> 
     <ul> 
      <li> <p><code>Implementation</code> class and all its members but the <code>method()</code> method</p> </li> 
      <li> <p><code>JustAClass</code> class and all its members but the <code>definitelyAPIMethod()</code> method</p> </li> 
     </ul> 
    </div> 
    <div class="paragraph"> 
     <p>The following elements will be analyzed:</p> 
    </div> 
    <div class="ulist"> 
     <ul> 
      <li> <p><code>MyAPI</code> class and all its members, including the <code>InnerImplementation</code> class</p> </li> 
      <li> <p><code>Implementation.method()</code> method</p> </li> 
      <li> <p><code>JustAClass.definitelyAPIMethod()</code> method</p> </li> 
     </ul> 
    </div> 
    <div class="paragraph"> 
     <p>The <code>Implementation</code> class is not included in the API analysis, because it’s not annotated by the <code>@Public</code> annotation. On the other hand, the <code>MyAPI.InnerImplementation</code> class <strong>is</strong> included in the API analysis, because it is a member of the the <code>MyAPI</code> class, which is annotated with <code>@Public</code> and there is no configuration for exclusion.</p> 
    </div> 
    <div class="paragraph"> 
     <p>Similarly, <code>JustAClass</code> and its members are not included, because they are not annotated by <code>@Public</code>.</p> 
    </div> 
    <div class="paragraph"> 
     <p>The situation with <code>Implementation.method()</code> and <code>JustAClass.definititelyAPIMethod()</code> is actually quite similar. In both, the presence of the <code>@Public</code> annotation overrides the decision about the parent element’s exclusion (this decision is based on the lack of the <code>@Public</code> annotation on the parents).</p> 
    </div> 
    <div class="paragraph"> 
     <p>Doing this might not seem particularly useful but there are scenarios, where it might be. Imagine that over the evolution of your library certain users became reliant on an implementation class that you never meant to be public. Over the time, you marked your certain methods or the whole class as <code>@Private</code> to really discourage users from using them yet you know of the importance of some method in the class that your clients depend on and don’t want to break the clients using it. You thus annotate it <code>@Public</code> even though it is in a non-public class.</p> 
    </div> 
   </div> 
   <div class="sect3"> 
    <h4 id="a_precise_control_using_both_code_public_code_and_code_private_code">Precise Control Using Both <code>@Public</code> and <code>@Private</code></h4> 
    <div class="paragraph"> 
     <p>This is of course a combination of both the approaches above but still is worth its own explanation.</p> 
    </div> 
    <div class="paragraph"> 
     <p>The configuration would look something like this:</p> 
    </div> 
    <div class="listingblock"> 
     <div class="content"> 
      <pre class="highlight"><code class="language-javascript" data-lang="javascript">[
  {
    "extension": "revapi.java.filter.annotated",
    "configuration": {
      "include": ["@my.annotations.Public"],
      "exclude": ["@my.annotations.Private"]
    }
  }
]</code></pre> 
     </div> 
    </div> 
    <div class="paragraph"> 
     <p>And the following elements will not be included in the analysis:</p> 
    </div> 
    <div class="ulist"> 
     <ul> 
      <li> <p><code>MyAPI.InnerImplementation</code> class (and all of its members, if there were any)</p> </li> 
      <li> <p><code>Implementation</code> class and all its members but the <code>method()</code> method</p> </li> 
      <li> <p><code>JustAClass</code> and all its members but the <code>definitelyAPIMethod()</code> method</p> </li> 
     </ul> 
    </div> 
    <div class="paragraph"> 
     <p>This is the most "intuitive" result and probably the one the author of the library anticipated when they annotated the methods and classes with the annotations.</p> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="col-md-4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#a_annotated_element_filter" title="Annotated Element Filter">Annotated Element Filter <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#a_sample_configuration" title="Sample Configuration">Sample Configuration</a>
		<li><a href="#a_properties" title="Properties">Properties</a>
		<li><a href="#a_notation" title="Notation">Notation</a>
		<li class="dropdown"><a href="#a_examples" title="Examples">Examples <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#a_leave_out_only_code_private_code_elements" title="Leave out only @Private Elements">Leave out only @Private Elements</a>
		<li><a href="#a_only_consider_code_public_code_elements" title="Only Consider @Public Elements">Only Consider @Public Elements</a>
		<li><a href="#a_precise_control_using_both_code_public_code_and_code_private_code" title="Precise Control Using Both @Public and @Private">Precise Control Using Both @Public and @Private</a>
			</ul>
		</li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="col-md-3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Basic Info</li>
						<li >
							<a href="../../../architecture.html" title="Architecture">Architecture</a>
						</li>
						<li >
							<a href="../../../building.html" title="Building">Building</a>
						</li>
						<li >
							<a href="../../../extensions.html" title="Extensions">Extensions</a>
						</li>
						<li class="nav-header">Sub Projects</li>
						<li >
							<a href="../../revapi/index.html" title="Revapi API">Revapi API</a>
						</li>
						<li >
							<a href="../../revapi-ant-task/index.html" title="Ant Task">Ant Task</a>
						</li>
						<li >
							<a href="../../revapi-basic-features/index.html" title="Basic Features">Basic Features</a>
						</li>
						<li >
							<a href="../index.html" title="Java Extension">Java Extension</a>
						</li>
						<li >
							<a href="../../revapi-java-spi/index.html" title="Java Extension SPI">Java Extension SPI</a>
						</li>
						<li >
							<a href="../../revapi-java-test-support/index.html" title="Java Test Support">Java Test Support</a>
						</li>
						<li >
							<a href="../../revapi-reporter-text/index.html" title="Text Report Extension">Text Report Extension</a>
						</li>
						<li >
							<a href="../../revapi-maven-plugin/index.html" title="Maven Plugin">Maven Plugin</a>
						</li>
					</ul>
				</div>
				<div class="col-md-3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Project Details</li>
						<li >
							<a href="../differences.html" title="Detected API differences">Detected API differences</a>
						</li>
						<li >
							<a href="../enhance-java-checks.html" title="Extending Java API Checks">Extending Java API Checks</a>
						</li>
						<li >
							<a href="java.html" title="Java Extension Configuration">Java Extension Configuration</a>
						</li>
						<li class="active">
							<a href="#" title="Annotated Element Filter Extension Configuration">Annotated Element Filter Extension Configuration</a>
						</li>
						<li >
							<a href="class-filter.html" title="Class Filter Extension">Class Filter Extension</a>
						</li>
						<li >
							<a href="package-filter.html" title="Package Filter Extension">Package Filter Extension</a>
						</li>
					</ul>
				</div>
				<div class="col-md-3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven Documentation</li>
						<li >
							<a href="../project-info.html" title="Project Information">Project Information <i class="glyphicon glyphicon-chevron-right"></i></a>
						</li>
						<li >
							<a href="../project-reports.html" title="Project Reports">Project Reports <i class="glyphicon glyphicon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
				<div class="col-md-3 bottom-description">
					<blockquote>Revapi Java Extension</blockquote>
					<blockquote class="version-date"><span class="projectVersion">Version: 0.14.4</span><br/><span class="publishDate">Last Published: 2017-10-31</span></blockquote>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="col-md-12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2017 <a href="http://lukas.krejci.pw">Lukas Krejci</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/tunguski/msb3-maven-skin" title="Msb3 Maven skin">Msb3 Maven skin</a> by <a href="http://matsuo.pl" target="_blank" title="Marek Romanowski">Marek Romanowski</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/msb3-scroll.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>

	<script src="../js/msb3-skin.js"></script>

	</body>
</html>